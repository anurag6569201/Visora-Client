{% extends "account/base_entrance.html" %}
{% load i18n %}
{% load static %}
{% load allauth account %}
{% block head_title %}
{% trans "Past Orders" %}
{% endblock head_title %}
{% block stylesheet %}
<style>
    .orders-table {
        border: 1px solid #ddd;
        font-size: 16px;
    }

    .orders-table th {
        background-color: #E9661D;
        color: white;
        text-align: center;
        padding: 12px;
    }

    .orders-table td {
        padding: 10px;
        vertical-align: middle;
        text-align: center;
    }

    .orders-table .btn-primary {
        background-color: #E9661D;
        border-color: #E9661D;
    }

    .orders-table .btn-primary:hover {
        background-color: #d45b18;
        border-color: #d45b18;
    }

    .orders-table .badge-success {
        background-color: #28a745;
    }

    .orders-table .badge-warning {
        background-color: #ffc107;
    }

    .no-orders {
        text-align: center;
        color: #888;
        font-size: 18px;
        margin-top: 20px;
    }

</style>
{% endblock stylesheet %}
{% block content %}
    <div class="container mt-5">
        <h2 class="mb-4">Your Past Orders ({{ past_orders.count }})</h2>
        
        {% if past_orders %}
        <div class="table-responsive">
            <table class="table table-striped table-bordered orders-table">
                <thead class="thead-dark" style="background-color: #E9661C; color: white;">
                    <tr>
                        <th>Order ID</th>
                        <th class="d-none d-md-table-cell">Payment ID</th>
                        <th class="">Invoice</th>
                        <th class="">Order Date</th>
                        <th class="d-none d-md-table-cell">Payment Status</th>
                        <th class="d-none d-md-table-cell">Payment Mode</th>
                        <th class="d-none d-md-table-cell">Delivery Address</th>
                    </tr>
                </thead>
                <tbody>
                    {% for order in past_orders %}
                    <tr class="mb-3">
                        <td data-label="Order ID">{{ order.order_id }}</td>
                        <td class="d-none d-md-table-cell" data-label="Payment ID">{{ order.payment_id }}</td>
                        <td class="" data-label="Invoice">
                            {% if order.pdf_invoice %}
                                <a href="{{ order.pdf_invoice.url }}" class="btn btn-sm btn-primary" target="_blank">Download</a>
                            {% else %}
                                No Invoice
                            {% endif %}
                        </td>
                        <td class="" data-label="Order Date">{{ order.created_at|date:"d M Y" }}</td>
                        <td class="d-none d-md-table-cell" data-label="Payment Status">
                            <span class="badge {% if order.payment_status == 'paid' %}badge-success{% else %}badge-warning{% endif %}">
                                {{ order.payment_status|title }}
                            </span>
                        </td>
                        <td class="d-none d-md-table-cell" data-label="Payment Mode">{{ order.payment_mode|title }}</td>
                        <td class="d-none d-md-table-cell" data-label="Delivery Address">
                            {% if order.delivery_address %}
                                {{ order.delivery_address|truncatechars:30 }}
                            {% else %}
                                No Address Provided
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="text-center">You have no past orders.</p>
        {% endif %}
    </div>
{% endblock content %}

{% block extra_body %}
{{ block.super }}
{% if PASSKEY_LOGIN_ENABLED %}
{% include "mfa/webauthn/snippets/login_script.html" with button_id="passkey_login" %}
{% endif %}
{% endblock %}